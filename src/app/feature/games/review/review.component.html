<ng-container *ngIf="!!review else loading">
    <ng-container *ngIf="!editing else editMode">
        <div class="card card-body">
            <div class="wrapper">
                <h5 class="card-title">Rating: <span [ngClass]="review.rating >= 5 ? 'positive' : 'negative'">{{review.rating}}</span></h5>
                <ng-container *ngIf="!!user else loading">
                    <ng-container *ngIf="!!user.username else anonymous">
                        <p class="card-title">{{user.username}}</p>
                    </ng-container>
                </ng-container>
            </div>
    
            <ng-container *ngIf="!!review.text">
                <p class="card-title">{{review.text}}</p>
            </ng-container>
            
            <div class="wrapper">
                <div *ngIf="canInteract">
                    <button class="btn btn-primary" (click)="toggleEditMode()">Update</button>
                    <button class="btn btn-danger" (click)="remove()">Delete</button>
                </div>
                <p class="text-right text-muted">{{review.postedAt | date: "dd MMM YYYY"}}</p>
            </div>
        </div>
    </ng-container>
</ng-container>

<ng-template #loading>
    <p>Loading...</p>
</ng-template>

<ng-template #anonymous>
    <p class="card-title">Anonymous</p>
</ng-template>

<ng-template #editMode>
    <app-add-review [editing]="true" [currentReview]="this.review" (updateItem)="updateReview($event)"></app-add-review>
    <button class="btn btn-danger m-3" (click)="toggleEditMode()" *ngIf="editing">Cancel</button>
</ng-template>